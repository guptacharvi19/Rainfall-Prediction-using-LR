# -*- coding: utf-8 -*-
"""rainfallpredLR.py

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1p3smq2dMs0vwaZDN9NQcVIorcHIfQzeE
"""

#pip install streamlit

import streamlit as st
import pandas as pd
from sklearn.linear_model import LinearRegression
from sklearn.model_selection import train_test_split

st.set_page_config(page_title = 'Rainfall Prediction', layout = 'centered')
st.title("Rainfall prediction system")
st.write("Rainfall prediction project") #written below the title

states = ["Maharashtra","Kerala","Tamil nadu","Rajasthan","Punjab"]
months = ["Jan","Feb","Mar","Apr","May","June","July","Aug","Sep","Oct"]

data = []

for state in states:
  for month_index, month in enumerate(months):
    for _ in range(4):  #4 records/month
      if month in ["June","July","Aug","Sep"]:
        rainfall = 150 + month_index * 5
        humidity = 75
        temp = 28
      else:
        rainfall = 20 + month_index * 2
        humidity = 45
        temp = 35

      if state == "Kerala":
        rainfall += 40
      elif state == "Rajasthan":
        rainfall -= 35

      wind_speed = 10 + month_index

      data.append([state,month,temp,humidity,wind_speed,rainfall])

df = pd.DataFrame(
    data,
    columns = [
        "State","Month","Avg_Temperature","Humidity","Wind_Speed","Rainfall_mm"
        ]
)

if st.checkbox('Show Dataset'):
  st.write(df.head(20))
  st.write("total records:", df.shape[0])

df_encoded = pd.get_dummies(df, drop_first = True)

X = df_encoded.drop("Rainfall_mm", axis = 1)
y = df_encoded["Rainfall_mm"]
X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.3, shuffle = False)
model = LinearRegression()
model.fit(X_train, y_train)

st.subheader("Enter Climate Deatils")

state_input = st.selectbox("Select State", states)
month_input = st.selectbox("Select Month", months)
temperature_input = st.slider("Avg temp in C", 20, 45, 30)
humidity_input = st.slider("Humidity %", 40, 90, 60)
wind_speed_input = st.slider("Wind Speed in kmph", 0, 20, 10)

input_data = pd.DataFrame([{"State": state_input, "Month": month_input, "Avg_temperature": temperature_input, "Humidity": humidity_input, "Wind_speed": wind_speed_input}])

input_encoded = pd.get_dummies(input_data, drop_first = True)
input_encoded = input_encoded.reindex(columns = X.columns, fill_value = 0)

if st.button("Predict"):
  prediction = model.predict(input_encoded)[0]
  st.success(f'Predicted rainfall: {prediction:.2f} mm')

st.write("---")
st.caption("CHARVI GUPTA") #streamlit run filename.py